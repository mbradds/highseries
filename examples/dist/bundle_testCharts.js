(()=>{var t={154:t=>{"use strict";var e,r,n,i,o,s,a,u,l,c,f,d,h,y,v;function p(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return x(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function _(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function g(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var b=0;function C(t){return"__private_"+b+++"_"+t}t.exports=(e=C("findDataType"),r=C("getUnique"),n=C("seriesProperties"),i=C("properxName"),o=C("yValues"),s=C("nonTidyOperation"),a=C("tidyOperation"),u=function(){function t(u){var p=u.df,m=u.chartType,x=void 0===m?void 0:m,_=u.xCol,g=void 0===_?void 0:_,b=u.yCols,C=void 0===b?void 0:b,T=u.filters,w=void 0===T?void 0:T,O=u.transform,j=void 0===O?void 0:O,P=u.valuesCol,A=void 0===P?void 0:P,k=u.colors,N=void 0===k?void 0:k,E=u.xName,S=void 0===E?"x":E;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,a,{value:v}),Object.defineProperty(this,s,{value:y}),Object.defineProperty(this,o,{value:h}),Object.defineProperty(this,i,{value:d}),Object.defineProperty(this,n,{value:f}),Object.defineProperty(this,r,{value:c}),Object.defineProperty(this,e,{value:l}),this._df=p,this._chartType=x,this._xCol=g,this._yCols=C,this._filters=w,this._transform=j,this._valuesCol=A,this._colors=N,this._xName=S,this._series=void 0}var u,p;return u=t,(p=[{key:"update",value:function(t){var e=t.df,r=void 0===e?this._df:e,n=t.chartType,i=void 0===n?this._chartType:n,o=t.xCol,s=void 0===o?this._xCol:o,a=t.yCols,u=void 0===a?this._yCols:a,l=t.filters,c=void 0===l?this._filters:l,f=t.transform,d=void 0===f?this._transform:f,h=t.valuesCol,y=void 0===h?this._valuesCol:h,v=t.colors,p=void 0===v?this._colors:v,m=t.xName,x=void 0===m?this._xName:m;this.df=r,this.chartType=i,this.xCol=s,this.yCols=u,this.filters=c,this.transform=d,this.valuesCol=y,this.colors=p,this.xName=x}},{key:"filter",value:function(t){for(var e=this,r=function(){var t=m(i[n],2),r=t[0],o=t[1];Array.isArray(o)?o.map((function(t){e.df=e.df.filter((function(e){return e[r]==t}))})):e.df=e.df.filter((function(t){return t[r]==o}))},n=0,i=Object.entries(t);n<i.length;n++)r();return this.df}},{key:"sort",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",r=[];return"asc"==e?r=this.df.slice().sort((function(e,r){return r[t]-e[t]})):"desc"==e&&(r=this.df.slice().sort((function(e,r){return e[t]-r[t]}))),this.df=r,this.df}},{key:"generate",value:function(){return g(this,e)[e](this.yCols,this.valuesCol),this.filters&&this.filter(this.filters),"non-tidy"==this.dataType?this._series=g(this,s)[s](this.xCol,this.yCols,this.transform,this.colors,this.xName):this._series=g(this,a)[a](this.xCol,this.yCols,this.transform,this.colors,this.valuesCol,this.xName),this._series}},{key:"df",get:function(){return this._df},set:function(t){this._df=t}},{key:"chartType",get:function(){return this._chartType},set:function(t){this._chartType=t}},{key:"colors",get:function(){return this._colors},set:function(t){this._colors=t}},{key:"xCol",get:function(){return this._xCol},set:function(t){this._xCol=t}},{key:"yCols",get:function(){return this._yCols},set:function(t){this._yCols=t}},{key:"filters",get:function(){return this._filters},set:function(t){this._filters=t}},{key:"transform",get:function(){return this._transform},set:function(t){this._transform=t}},{key:"valuesCol",get:function(){return this._valuesCol},set:function(t){this._valuesCol=t}},{key:"xName",get:function(){return this._xName},set:function(t){this._xName=t}},{key:"dataType",get:function(){return this._dataType},set:function(t){this._dataType=t}}])&&_(u.prototype,p),t}(),l=function(t,e){Array.isArray(t)&&null==e?this._dataType="non-tidy":this._dataType="tidy"},c=function(t){for(var e,r={},n=[],i=0;e=this.df[i++];){var o=e[t];o in r||(r[o]=1,n.push(o))}return n},f=function(t){return void 0!==t?function(t,e,r){return{name:t,data:e,color:r[t]}}:function(t,e,r){return{name:t,data:e}}},d=function(t){return void 0!==t?t:null==this._chartType?(this.xName="x","x"):void(["line","area"].includes(this._chartType)&&(this.xName="x"))},h=function(t){if(!t)return function(t,e){return t[e]};if(t&&t.hasOwnProperty("decimals")&&!t.hasOwnProperty("operator"))return function(e,r){return null!==e[r]?+e[r].toFixed(t.decimals):e[r]};if(t&&t.hasOwnProperty("operator"))if(t.hasOwnProperty("decimals")){if("*"==t.operator)return function(e,r){return null!==e[r]?+(e[r]*t.conversion).toFixed(t.decimals):e[r]};if("/"==t.operator)return function(e,r){return null!==e[r]?+(e[r]/t.conversion).toFixed(t.decimals):e[r]};if("+"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]+t.conversion).toFixed(t.decimals):e[r]};if("-"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]-t.conversion).toFixed(t.decimals):e[r]}}else{if("*"==t.operator)return function(e,r){return null!==e[r]?+e[r]*t.conversion:e[r]};if("/"==t.operator)return function(e,r){return null!==e[r]?+e[r]/t.conversion:e[r]};if("+"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]+t.conversion):e[r]};if("-"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]-t.conversion):e[r]}}},y=function(t,e,r,s,a){var u=this,l={},c={};e.map((function(t){l[t]=[],c[t]=0})),g(this,i)[i](a);var f=g(this,o)[o](r);this.df.map((function(r){e.map((function(e){var n;l[e].push((p(n={},u.xName,r[t]),p(n,"y",f(r,e)),n)),c[e]=c[e]+r[e]}))}));for(var d=[],h=g(this,n)[n](s),y=0,v=Object.entries(l);y<v.length;y++){var x=m(v[y],2),_=x[0],b=x[1];0!==c[_]&&d.push(h(_,b,s))}return d},v=function(t,e,s,a,u,l){var c=this,f=g(this,r)[r](e),d=g(this,o)[o](s),h=g(this,n)[n](a);return g(this,i)[i](l),f.map((function(r){var n=c.df.filter((function(t){return t[e]==r})).map((function(e){var r;return p(r={},c.xName,e[t]),p(r,"y",d(e,u)),r}));return h(r,n,a)}))},u)}},e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}(()=>{function t(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==a.return||a.return()}finally{if(i)throw o}}return r}}(t,r)||function(t,r){if(t){if("string"==typeof t)return e(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var n=r(154),i=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),JSON.parse(e.responseText)},o=i("./test_data/non-tidy.json"),s=i("./test_data/tidy.json"),a=function(t,e){return new Highcharts.chart(e,{chart:{type:"line",zoomType:"x",borderWidth:1},tooltip:{shared:!0},yAxis:{title:{text:"Exports (Mb/d)"}},xAxis:{type:"datetime",crosshair:!0},series:t})},u={conversion:159,operator:"*",decimals:2},l={Marine:"Red",Pipeline:"Blue",Railway:"Green",Truck:"Yellow"},c={Product:"Propane",Origin:"Canada"},f=t(function(t,e){var r=performance.now(),i=new n({df:t,chartType:"line",colors:l});i.xCol="Period",i.yCols="Mode of Transportation",i.valuesCol="Volume (Mb/d)",i.filters=e;var o=i.generate(),s=a(o,"container-tidy"),u=performance.now();return s.update({title:{text:"Tidy load time: ".concat((u-r).toFixed(1)," milliseconds")}}),[s,i]}(s,c),2),d=f[0],h=f[1],y=t(function(t,e){var r=performance.now(),i=new n({df:t,chartType:"line",colors:l});i.xCol="Period",i.yCols=["Marine","Pipeline","Railway","Truck"],i.filters=e;var o=i.generate(),s=a(o,"container-nonTidy"),u=performance.now();return s.update({title:{text:"Non-tidy load time: ".concat((u-r).toFixed(1)," milliseconds")}}),[s,i]}(o,c),2),v=y[0],p=y[1],m=function(t,e,r,n){var i=performance.now();e.update({df:n,filters:r});for(var o=0;o<t.series.length;o++)t.series[o].setData([]);return t.update({series:e.generate(),title:{text:"Tidy update time ".concat((performance.now()-i).toFixed(1)," milliseconds")}}),[t,e]};document.getElementById("select-product").addEventListener("change",(function(e){c.Product=e.target.value;var r=t(m(d,h,c,s),2);d=r[0],h=r[1];var n=t(m(v,p,c,o),2);v=n[0],p=n[1]})),document.getElementById("select-region").addEventListener("change",(function(e){c.Origin=e.target.value;var r=t(m(d,h,c,s),2);d=r[0],h=r[1];var n=t(m(v,p,c,o),2);v=n[0],p=n[1]})),document.getElementById("select-units").addEventListener("change",(function(t){var e=t.target.value;"Mb/d"==e?(h.update({df:s,transform:!1}),p.update({df:o,transform:!1})):(h.update({df:s,transform:u}),p.update({df:o,transform:u})),d.update({series:h.generate(),yAxis:{title:{text:"Exports ".concat(e)}}}),v.update({series:p.generate(),yAxis:{title:{text:"Exports ".concat(e)}}})}))})()})();