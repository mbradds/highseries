(()=>{"use strict";var t={154:t=>{function e(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t,e){if(!Object.prototype.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}var a=0;function s(t){return"__private_"+a+++"_"+t}var u=s("findDataType"),l=s("getUnique"),c=s("seriesProperties"),f=s("properxName"),d=s("yValues"),h=s("nonTidyOperation"),y=s("tidyOperation"),p=function(){function t(e){var r=e.data,n=e.chartType,i=void 0===n?void 0:n,o=e.xCol,a=void 0===o?void 0:o,s=e.yCols,p=void 0===s?void 0:s,w=e.filters,T=void 0===w?void 0:w,O=e.transform,j=void 0===O?void 0:O,P=e.valuesCol,A=void 0===P?void 0:P,k=e.colors,N=void 0===k?void 0:k,E=e.xName,S=void 0===E?"x":E;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.defineProperty(this,y,{value:C}),Object.defineProperty(this,h,{value:_}),Object.defineProperty(this,d,{value:b}),Object.defineProperty(this,f,{value:g}),Object.defineProperty(this,c,{value:x}),Object.defineProperty(this,l,{value:m}),Object.defineProperty(this,u,{value:v}),this._data=r,this._chartType=i,this._xCol=a,this._yCols=p,this._filters=T,this._transform=j,this._valuesCol=A,this._colors=N,this._xName=S,this._series=void 0}var e,n;return e=t,(n=[{key:"update",value:function(t){t.data?this.data=t.data:t.chartType?this.chartType=t.chartType:t.xCol?this.xCol=t.xCol:t.yCols?this.yCols=t.yCols:t.filters?this.filters=t.filters:t.transform?this.transform=t.transform:t.valuesCol?this.valuesCol=t.valuesCol:t.colors?this.colors=t.colors:t.xName&&(this.xName=t.xName)}},{key:"filter",value:function(t){for(var e=this,n=function(){var t=r(o[i],2),n=t[0],a=t[1];Array.isArray(a)?a.map((function(t){e.data=e.data.filter((function(e){return e[n]==t}))})):e.data=e.data.filter((function(t){return t[n]==a}))},i=0,o=Object.entries(t);i<o.length;i++)n();return this.data}},{key:"sort",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",r=[];return"asc"==e?r=this.data.slice().sort((function(e,r){return r[t]-e[t]})):"desc"==e&&(r=this.data.slice().sort((function(e,r){return e[t]-r[t]}))),this.data=r,this.data}},{key:"generate",value:function(){return o(this,u)[u](this.yCols,this.valuesCol),this.filters&&this.filter(this.filters),"non-tidy"==this.dataType?this._series=o(this,h)[h](this.xCol,this.yCols,this.transform,this.colors,this.xName):this._series=o(this,y)[y](this.xCol,this.yCols,this.transform,this.colors,this.valuesCol,this.xName),this._series}},{key:"data",get:function(){return this._data},set:function(t){this._data=t}},{key:"chartType",get:function(){return this._chartType},set:function(t){this._chartType=t}},{key:"colors",get:function(){return this._colors},set:function(t){this._colors=t}},{key:"xCol",get:function(){return this._xCol},set:function(t){this._xCol=t}},{key:"yCols",get:function(){return this._yCols},set:function(t){this._yCols=t}},{key:"filters",get:function(){return this._filters},set:function(t){this._filters=t}},{key:"transform",get:function(){return this._transform},set:function(t){this._transform=t}},{key:"valuesCol",get:function(){return this._valuesCol},set:function(t){this._valuesCol=t}},{key:"xName",get:function(){return this._xName},set:function(t){this._xName=t}},{key:"dataType",get:function(){return this._dataType},set:function(t){this._dataType=t}}])&&i(e.prototype,n),t}(),v=function(t,e){Array.isArray(t)&&null==e?this._dataType="non-tidy":this._dataType="tidy"},m=function(t){for(var e,r={},n=[],i=0;e=this.data[i++];){var o=e[t];o in r||(r[o]=1,n.push(o))}return n},x=function(t){return void 0!==t?function(t,e,r){return{name:t,data:e,color:r[t]}}:function(t,e,r){return{name:t,data:e}}},g=function(t){return void 0!==t?t:null==this._chartType?(this.xName="x","x"):void(["line","area"].includes(this._chartType)&&(this.xName="x"))},b=function(t){if(!t)return function(t,e){return t[e]};if(t&&t.hasOwnProperty("decimals")&&!t.hasOwnProperty("operator"))return function(e,r){return null!==e[r]?+e[r].toFixed(t.decimals):e[r]};if(t&&t.hasOwnProperty("operator"))if(t.hasOwnProperty("decimals")){if("*"==t.operator)return function(e,r){return null!==e[r]?+(e[r]*t.conversion).toFixed(t.decimals):e[r]};if("/"==t.operator)return function(e,r){return null!==e[r]?+(e[r]/t.conversion).toFixed(t.decimals):e[r]};if("+"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]+t.conversion).toFixed(t.decimals):e[r]};if("-"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]-t.conversion).toFixed(t.decimals):e[r]}}else{if("*"==t.operator)return function(e,r){return null!==e[r]?+e[r]*t.conversion:e[r]};if("/"==t.operator)return function(e,r){return null!==e[r]?+e[r]/t.conversion:e[r]};if("+"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]+t.conversion):e[r]};if("-"==t.conversion)return function(e,r){return null!==e[r]?+(e[r]-t.conversion):e[r]}}},_=function(t,n,i,a,s){var u=this,l={},h={};n.map((function(t){l[t]=[],h[t]=0})),o(this,f)[f](s);var y=o(this,d)[d](i);this.data.map((function(r){n.map((function(n){var i;l[n].push((e(i={},u.xName,r[t]),e(i,"y",y(r,n)),i)),h[n]=h[n]+r[n]}))}));for(var p=[],v=o(this,c)[c](a),m=0,x=Object.entries(l);m<x.length;m++){var g=r(x[m],2),b=g[0],_=g[1];0!==h[b]&&p.push(v(b,_,a))}return p},C=function(t,r,n,i,a,s){var u=this,h=o(this,l)[l](r),y=o(this,d)[d](n),p=o(this,c)[c](i);return o(this,f)[f](s),h.map((function(n){var o=u.data.filter((function(t){return t[r]==n})).map((function(r){var n;return e(n={},u.xName,r[t]),e(n,"y",y(r,a)),n}));return p(n,o,i)}))};t.exports=p}},e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=r(154),e=r.n(t);function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){i=!0,o=t}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var o=function(t){var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),JSON.parse(e.responseText)},a=o("./test_data/non-tidy.json"),s=o("./test_data/tidy.json"),u=function(t,e){return new Highcharts.chart(e,{chart:{type:"line",zoomType:"x",borderWidth:1},tooltip:{shared:!0},yAxis:{title:{text:"Exports (Mb/d)"}},xAxis:{type:"datetime",crosshair:!0},series:t})},l={conversion:159,operator:"*",decimals:2},c={Marine:"Red",Pipeline:"Blue",Railway:"Green",Truck:"Yellow"},f={Product:"Propane",Origin:"Canada"},d=n(function(t,r){var n=performance.now(),i=new(e())({data:t,chartType:"line",colors:c});i.xCol="Period",i.yCols="Mode of Transportation",i.valuesCol="Volume (Mb/d)",i.filters=r;var o=i.generate(),a=u(o,"container-tidy"),s=performance.now();return a.update({title:{text:"Tidy load time: ".concat((s-n).toFixed(1)," milliseconds")}}),[a,i]}(s,f),2),h=d[0],y=d[1],p=n(function(t,r){var n=performance.now(),i=new(e())({data:t,chartType:"line",colors:c});i.xCol="Period",i.yCols=["Marine","Pipeline","Railway","Truck"],i.filters=r;var o=i.generate(),a=u(o,"container-nonTidy"),s=performance.now();return a.update({title:{text:"Non-tidy load time: ".concat((s-n).toFixed(1)," milliseconds")}}),[a,i]}(a,f),2),v=p[0],m=p[1],x=function(t,e,r,n){var i=performance.now();e.update({data:n,filters:r});for(var o=0;o<t.series.length;o++)t.series[o].setData([]);return t.update({series:e.generate(),title:{text:"Tidy update time ".concat((performance.now()-i).toFixed(1)," milliseconds")}}),[t,e]};document.getElementById("select-product").addEventListener("change",(function(t){f.Product=t.target.value;var e=n(x(h,y,f,s),2);h=e[0],y=e[1];var r=n(x(v,m,f,a),2);v=r[0],m=r[1]})),document.getElementById("select-region").addEventListener("change",(function(t){f.Origin=t.target.value;var e=n(x(h,y,f,s),2);h=e[0],y=e[1];var r=n(x(v,m,f,a),2);v=r[0],m=r[1]})),document.getElementById("select-units").addEventListener("change",(function(t){var e=t.target.value;"Mb/d"==e?(y.update({data:s,transform:!1}),m.update({data:a,transform:!1})):(y.update({data:s,transform:l}),m.update({data:a,transform:l})),h.update({series:y.generate(),yAxis:{title:{text:"Exports ".concat(e)}}}),v.update({series:m.generate(),yAxis:{title:{text:"Exports ".concat(e)}}})}))})()})();